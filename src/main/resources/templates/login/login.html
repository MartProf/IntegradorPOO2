<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesi√≥n - SGFS</title>
    <link rel="stylesheet" th:href="@{/css/auth.css}">
</head>
<body>

<div class="auth-container">
    <div class="auth-header">
        <h2>Bienvenido</h2>
        <p>Inicia sesi√≥n para continuar</p>
    </div>

    <!-- Mensajes de error y √©xito -->
    <div th:if="${param.error}" class="alert alert-error">
        <strong>Error:</strong> Usuario o contrase√±a incorrectos.
    </div>

    <div th:if="${param.logout}" class="alert alert-success">
        Has cerrado sesi√≥n correctamente.
    </div>
    
    <div th:if="${param.registrado}" class="alert alert-success">
        <strong>¬°Registro exitoso!</strong> Ahora puedes ingresar.
    </div>

    <div th:if="${param.bloqueado}" class="alert alert-error">
        Tu cuenta ha sido bloqueada. Contacta al administrador.
    </div>

    <form th:action="@{/login}" method="post" id="loginForm">
        <div class="form-group">
            <label for="username">
                Nombre de Usuario
                <span class="required-mark">*</span>
            </label>
            <input 
                type="text" 
                id="username" 
                name="username" 
                placeholder="Ingresa tu usuario"
                required 
                autofocus
                autocomplete="username"
                minlength="3"
                maxlength="50" />
        </div>

        <div class="form-group">
            <label for="password">
                Contrase√±a
                <span class="required-mark">*</span>
            </label>
            <div class="password-toggle">
                <input 
                    type="password" 
                    id="password" 
                    name="password" 
                    placeholder="Ingresa tu contrase√±a"
                    required
                    autocomplete="current-password"
                    minlength="4" />
                <button type="button" class="password-toggle-btn" onclick="togglePassword()">
                    üëÅÔ∏è
                </button>
            </div>
        </div>

        <button type="submit" class="btn btn-primary">Iniciar Sesi√≥n</button>
    </form>

    <div class="auth-footer">
        <p>
            ¬øNo tienes cuenta? 
            <a th:href="@{/registro}">Reg√≠strate aqu√≠</a>
        </p>
    </div>
</div>

<script>
    function togglePassword() {
        const passwordInput = document.getElementById('password');
        const toggleBtn = document.querySelector('.password-toggle-btn');
        
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            toggleBtn.textContent = 'üôà';
        } else {
            passwordInput.type = 'password';
            toggleBtn.textContent = 'üëÅÔ∏è';
        }
    }

    // Validaci√≥n adicional del formulario
    document.getElementById('loginForm').addEventListener('submit', function(e) {
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value;
        
        if (username.length < 3) {
            e.preventDefault();
            alert('El nombre de usuario debe tener al menos 3 caracteres');
            return;
        }
        
        if (password.length < 4) {
            e.preventDefault();
            alert('La contrase√±a debe tener al menos 4 caracteres');
            return;
        }
        
        // A√±adir efecto de carga al bot√≥n
        const submitBtn = this.querySelector('button[type="submit"]');
        submitBtn.classList.add('loading');
        submitBtn.disabled = true;
    });
</script>

</body>
</html>